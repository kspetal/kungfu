"use strict";const e=require("../../common/vendor.js"),t=require("../../services/api.js"),n={data:()=>({summary:{totalRevenue:0,activeStudents:0},revenueRank:[],expiringStudents:[],defaultAvatar:"/static/logo.png"}),onShow(){this.loadAll()},onPullDownRefresh(){this.loadAll((()=>{e.index.stopPullDownRefresh()}))},methods:{async loadAll(e){try{const[n,a,r]=await Promise.all([t.fetchStatsSummary(),t.fetchRevenueRank(),t.fetchExpiringStudents(30)]);this.summary=n||this.summary,this.revenueRank=a||[],this.expiringStudents=r||[]}catch(n){console.error("load stats error",n)}finally{"function"==typeof e&&e()}},formatAmount:e=>e?e>=1e4?(e/1e4).toFixed(1)+"w":Number(e).toLocaleString("zh-CN"):"0"}};const a=e._export_sfc(n,[["render",function(t,n,a,r,o,s){return e.e({a:e.t(s.formatAmount(o.summary.totalRevenue)),b:e.t(o.summary.activeStudents||0),c:e.f(o.revenueRank,((t,n,a)=>({a:e.t(n+1),b:e.n("rank-index-"+(n+1)),c:e.t(t.project),d:e.t(s.formatAmount(t.amount)),e:t.project||n}))),d:0===o.revenueRank.length},(o.revenueRank.length,{}),{e:e.f(o.expiringStudents,((t,n,a)=>({a:t.avatarUrl||o.defaultAvatar,b:e.t(t.name),c:e.t(t.project),d:e.t(t.endDate),e:t.id}))),f:0===o.expiringStudents.length},(o.expiringStudents.length,{}))}],["__scopeId","data-v-23a2846f"]]);wx.createPage(a);
